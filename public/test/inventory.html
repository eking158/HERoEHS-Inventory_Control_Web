<!DOCTYPE html>
<html lang="kr">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="/test/css/list_box.css" />
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
  <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

  <script type="text/javascript">
    var s = location.href;
    var box_id = parseInt(s.split('/')[4]);
    var storage_id = s.split('/')[3];
    //document.writeln(storage_id);
    </script>

  <script type="text/javascript">
    if(storage_id == "storage_1")
      document.write("<title>창고 1 "+box_id+"번 박스 재고 목록</title>");
    if(storage_id == "storage_2")
      document.write("<title>창고 2 "+box_id+"번 박스 재고 목록</title>");
    if(storage_id == "406")
      document.write("<title>406호 "+box_id+"번 박스 재고 목록</title>");
  </script>

  <script>
  $( function() {
    //$( "#dialog" ).dialog();
    $( "#tabs" ).tabs();
    $.getJSON("/test/inventory.json",function(data){
      if(box_id==0){
        $.each(data[storage_id+"_consume"],function(index,value){
            $('#mp').append(
                "<div class=list_box onclick=detail("+value.id+")><tr><td><img class=list_box_image src=/images/objects/"+value.name+".png></td></tr></div>"
            );
        })
      }
      else{
        $.each(data[storage_id],function(index,value){
          if(value.box==box_id){
            $('#mp').append(
              "<div class=list_box onclick=detail("+value.id+")>\
                <table class=list_box_table height=100%>\
                <tr>\
                    <td width=20% rowspan=2>\
                      <img class=list_box_image src=/images/objects/"+value.name+".png onerror=this.src='/images/logos/logo.png';>\
                    </td>\
                    <td width=28%>물품명: " +value.name+"</td>\
                    <td width=15%>창고 위치: " +value.room+"</td>\
                    <td width=25%>대분류: " +value.L_category+"</td>\
                    <td width=32% class=text-center rowspan=2 style=font-size:1.6vmin;>"+value.etc+"</td>\
                  </tr>\
                  <tr>\
                    <td>수량: " +value.count+"</td>\
                    <td>박스 위치: " +value.box+"</td>\
                    <td>소분류: " +value.S_category+"</td>\
                  </tr>\
                  </table>\
                </div>"
            );
          }
        })
      }
    })
  });
  
  function detail(id)
  {
      $.getJSON("/test/inventory.json",function(data){
        if(box_id==0){  //소모품만 분류
          $.each(data[storage_id+"_consume"],function(index,value){
                if(value.id==id)
                {
                    $('#picture').attr("src","/images/objects/"+value.name+".png");
                    $('#name').text(value.name);
                    $('#L_category').text(value.L_category);
                    $('#S_category').text(value.S_category);
                    $('#room').text(value.room);
                    $('#box').text(value.box);
                    $('#count').text(value.count);
                    $('#etc').text(value.etc);
                    
                    $("#dialog").dialog({ 
                         autoOpen: true, 
                         width: 400,
                         height:600,
                         modal: true
                    });
                    return true;
                }
            })
        }
        else{//소모품 아닌 것들 분류
          $.each(data[storage_id],function(index,value){
                if(value.id==id)
                {
                    $('#picture').attr("src","/images/objects/"+value.name+".png");
                    $('#name').text(value.name);
                    $('#L_category').text(value.L_category);
                    $('#S_category').text(value.S_category);
                    $('#room').text(value.room);
                    $('#box').text(value.box);
                    $('#count').text(value.count);
                    $('#etc').text(value.etc);
                    
                    $("#dialog").dialog({ 
                         autoOpen: true, 
                         width: 400,
                         height:600,
                         modal: true
                    });
                    return true;
                }
            })
          }
        });
  }
  </script>
</head>

<body>
  <div class="container">
    <div>
      <script type="text/javascript">
        if(storage_id == "storage_1")
          document.write("<h3 class=text-center>창고 1 "+box_id+"번 박스 재고 목록</h3>");
        if(storage_id == "storage_2")
          document.write("<h3 class=text-center >창고 2 "+box_id+"번 박스 재고 목록</h3>");
        if(storage_id == "406")
          document.write("<h3 class=text-center>406호 "+box_id+"번 박스 재고 목록</h3>");
      </script>
      <table class="table">
        <tr id="mp"></tr>
      </table>
    </div>
    <div class="col-sm-6">
      <div id="dialog" title="물품 상세" style="display:none">
        <table class="table">
          <tr>
            <td width="20%" class="text-center" colspan="2">
              <img src="" height=120vmin id="picture" onerror="this.src='/images/logos/logo_inverted.png';">
            </td>
          </tr>
          <tr>
            <td width=20% class="text-right">물품명:</td>
            <td width=50% class="text-left" id="name"></td>
          </tr>
          <tr>
            <td width=20% class="text-right">대분류:</td>
            <td width=50% class="text-left" id="L_category"></td>
          </tr>
          <tr>
            <td width=20% class="text-right">소분류:</td>
            <td width=50% class="text-left" id="S_category"></td>
          </tr>
          <tr>
            <td width=20% class="text-right">창고 위치:</td>
            <td width=50% class="text-left" id="room"></td>
          </tr>
          <tr>
            <td width=20% class="text-right">박스 위치:</td>
            <td width=50% class="text-left" id="box"></td>
          </tr>
          <tr>
            <td width=20% class="text-right">수량:</td>
            <td width=50% class="text-left" id="count"></td>
          </tr>
          <tr>
            <td width=20% class="text-right">수량 변경:</td>
            <td width=50% class="text-left">
              <input type="number" min="0" max="100" />
              <input type="submit" value="변경" />
            </td>
          </tr>
          <tr>
            <td colspan="3" valign="top" id="etc"></td>
          </tr>
        </table>
      </div>
   </div>
  </div>
</body>
</html>
